<modules:BaseSimpleModule
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:modules="clr-namespace:Vivit_Control_Center.Views.Modules"
    x:Class="Vivit_Control_Center.Views.Modules.ScriptingModule"
    Background="White">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Top toolbar -->
        <ToolBarTray Grid.Row="0">
            <ToolBar>
                <Button Name="btnRun" Click="btnRun_Click" ToolTip="{DynamicResource Scripting.RunTooltip}" Padding="6,2">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text=">>" Margin="0,0,6,0" />
                        <TextBlock Text="{DynamicResource Scripting.Run}" />
                    </StackPanel>
                </Button>
                <Separator />
                <Button Name="btnOpen" Click="btnOpen_Click" ToolTip="{DynamicResource Scripting.OpenTooltip}" Padding="6,2" Content="{DynamicResource Scripting.Open}" />
                <Button Name="btnSave" Click="btnSave_Click" ToolTip="{DynamicResource Scripting.SaveTooltip}" Padding="6,2" Content="{DynamicResource Scripting.Save}" />
                <Button Name="btnSaveAs" Click="btnSaveAs_Click" ToolTip="{DynamicResource Scripting.SaveAsTooltip}" Padding="6,2" Content="{DynamicResource Scripting.SaveAs}" />
                <Separator />
                <Button Command="ApplicationCommands.Undo" Padding="6,2" Content="{DynamicResource Scripting.Undo}" />
                <Button Command="ApplicationCommands.Redo" Padding="6,2" Content="{DynamicResource Scripting.Redo}" />
                <Separator />
                <Button Command="ApplicationCommands.Cut" Padding="6,2" Content="{DynamicResource Scripting.Cut}" />
                <Button Command="ApplicationCommands.Copy" Padding="6,2" Content="{DynamicResource Scripting.Copy}" />
                <Button Command="ApplicationCommands.Paste" Padding="6,2" Content="{DynamicResource Scripting.Paste}" />
                <Separator />
                <Button Name="btnClear" Click="btnClear_Click" Padding="6,2" Content="{DynamicResource Scripting.Clear}" />
                <Separator />
                <TextBlock Text="{DynamicResource Scripting.LanguageLabel}" VerticalAlignment="Center" Margin="8,0,4,0" />
                <TextBlock Name="txtDetectedLanguage" FontWeight="Bold" VerticalAlignment="Center" />
            </ToolBar>
        </ToolBarTray>

        <!-- Main editor/output area -->
        <Grid Grid.Row="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="5" />
                <RowDefinition Height="2*" />
            </Grid.RowDefinitions>

            <Grid Grid.Row="0">
                <TextBox Name="txtScript"
                         AcceptsReturn="True"
                         AcceptsTab="True"
                         VerticalScrollBarVisibility="Auto"
                         HorizontalScrollBarVisibility="Auto"
                         FontFamily="Consolas"
                         FontSize="14"
                         TextChanged="txtScript_TextChanged"
                         KeyDown="txtScript_KeyDown"
                         PreviewKeyDown="txtScript_PreviewKeyDown"
                         Padding="6"/>

                <!-- Simple completion popup -->
                <Popup Name="completionPopup"
                       PlacementTarget="{Binding ElementName=txtScript}"
                       Placement="RelativePoint"
                       StaysOpen="False"
                       AllowsTransparency="True"
                       PopupAnimation="Fade"
                       Width="260">
                    <Border Background="#FF2D2D30" BorderBrush="#FF3F3F46" BorderThickness="1" CornerRadius="4">
                        <ListBox Name="completionList" MouseDoubleClick="completionList_MouseDoubleClick"
                                 Foreground="White" Background="Transparent"
                                 PreviewKeyDown="completionList_PreviewKeyDown"/>
                    </Border>
                </Popup>
            </Grid>

            <GridSplitter Grid.Row="1" Height="5" HorizontalAlignment="Stretch" Background="#FFE5E5E5" />

            <TextBox Grid.Row="2" Name="txtOutput" IsReadOnly="True"
                     VerticalScrollBarVisibility="Auto"
                     HorizontalScrollBarVisibility="Auto"
                     FontFamily="Consolas" FontSize="13" Padding="6"
                     TextWrapping="NoWrap"/>
        </Grid>
    </Grid>
</modules:BaseSimpleModule>